[
  {
    "category": "backend",
    "description": "Create folders table and migrate existing data",
    "steps": [
      "Create folders table with id, name, position, created_at",
      "Add folder_id column to todos table with foreign key",
      "Add folder_id column to tags table with foreign key",
      "Create migration that creates 'Default' folder and assigns existing todos/tags to it"
    ],
    "shouldCommit": true,
    "passes": true,
    "notes": "Run cargo check after changes. Ensure CASCADE delete is configured."
  },
  {
    "category": "backend",
    "description": "Implement folder CRUD commands",
    "steps": [
      "Create folder_get_all command returning folders with todoCount and recentTodos (last 2)",
      "Create folder_create command",
      "Create folder_rename command",
      "Create folder_delete command",
      "Create folder_reorder command accepting ordered list of IDs",
      "Register commands in main.rs"
    ],
    "shouldCommit": true,
    "passes": true,
    "notes": "Read existing todo.rs commands for pattern reference."
  },
  {
    "category": "backend",
    "description": "Update existing todo/tag commands to use folder_id",
    "steps": [
      "Replace todo_get_all with todo_get_by_folder(folder_id)",
      "Update todo_create to receive folder_id parameter",
      "Update tag_create to receive folder_id parameter",
      "Ensure tag uniqueness is scoped per folder, not global"
    ],
    "shouldCommit": true,
    "passes": true,
    "notes": "Check how tag_create validates uniqueness and update to filter by folder_id."
  },
  {
    "category": "frontend",
    "description": "Add Folder type and update useTodoStorage hook",
    "steps": [
      "Add Folder interface to types.ts",
      "Add folder operations to useTodoStorage hook (getAll, create, rename, delete, reorder)",
      "Update existing todo/tag operations to include folder_id",
      "Implement optimistic updates for folder operations"
    ],
    "shouldCommit": true,
    "passes": true,
    "notes": "Read useTodoStorage.ts for existing optimistic update patterns."
  },
  {
    "category": "frontend",
    "description": "Implement folder list view (main screen)",
    "steps": [
      "Create FolderList view showing all folders",
      "Create FolderCard component with name, todoCount, and 2 recent todos preview",
      "Add '+' button in header that reveals inline input for new folder",
      "Implement folder click to navigate into folder"
    ],
    "shouldCommit": true,
    "passes": true,
    "notes": "Use existing header customization system. Empty folders show '(empty)' in preview."
  },
  {
    "category": "frontend",
    "description": "Implement folder content view with navigation",
    "steps": [
      "Add back button in header when inside a folder",
      "Show folder name in header",
      "Add settings icon that opens menu with Rename/Delete options",
      "Add 'Tasks' title above todo list",
      "Remove border between tag filter and todo list"
    ],
    "shouldCommit": true,
    "passes": true,
    "notes": "Reuse existing TodoPlugin list/input components. Header shows: <- FolderName (gear icon)"
  },
  {
    "category": "frontend",
    "description": "Implement folder rename functionality",
    "steps": [
      "Create inline input or simple modal for rename",
      "Validate non-empty name",
      "Update folder name optimistically",
      "Handle errors with toast"
    ],
    "shouldCommit": true,
    "passes": true,
    "notes": "Triggered from settings menu inside folder view."
  },
  {
    "category": "frontend",
    "description": "Implement folder delete with countdown confirmation",
    "steps": [
      "Create DeleteFolderModal component",
      "Show message: Delete [name]? This will remove X todos and Y tags.",
      "Delete button disabled with countdown (5s to 0s then enabled)",
      "Execute delete and navigate back to folder list"
    ],
    "shouldCommit": true,
    "passes": true,
    "notes": "Use setInterval for countdown. Button text: 'Delete (5s)' then 'Delete'."
  },
  {
    "category": "frontend",
    "description": "Implement drag and drop folder reordering",
    "steps": [
      "Add drag handle or make entire folder card draggable",
      "Show visual indicator of drop position",
      "Update positions optimistically on drop",
      "Call folder_reorder with new order"
    ],
    "shouldCommit": true,
    "passes": false,
    "notes": "Consider using @dnd-kit/core or native HTML drag and drop API."
  },
  {
    "category": "test",
    "description": "Manual verification of folder system",
    "steps": [
      "Verify migration creates 'Default' folder with existing data",
      "Test create, rename, delete folder flows",
      "Test drag and drop reordering",
      "Test delete countdown modal",
      "Test navigation between folders",
      "Run cargo check and bun tsc --noEmit"
    ],
    "shouldCommit": false,
    "passes": false,
    "notes": "Test with existing todo data to ensure migration works correctly."
  }
]
